USE DEFAULT;

DROP TABLE CDW_SAPP_D_BRANCH_ONE;

CREATE  EXTERNAL TABLE CDW_SAPP_D_BRANCH_ONE(
BRANCH_CODE int,
BRANCH_NAME string,
BRANCH_STREET string, 
BRANCH_CITY string,
BRANCH_STATE string,
BRANCH_ZIP int,
BRANCH_PHONE string,
LAST_UPDATED timestamp) 
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'
LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_D_BRANCH";

DROP TABLE CDW_SAPP_D_BRANCH;

SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;

CREATE  EXTERNAL TABLE CDW_SAPP_D_BRANCH
(BRANCH_CODE int, 
BRANCH_NAME string, 
BRANCH_STREET string, 
BRANCH_CITY string, 
BRANCH_ZIP int, 
BRANCH_PHONE string , 
LAST_UPDATED timestamp) 
PARTITIONED BY (BRANCH_STATE string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'

LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_D_BRANCH10";


SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;
INSERT OVERWRITE TABLE CDW_SAPP_D_BRANCH
PARTITION (BRANCH_STATE)
SELECT BRANCH_CODE,
BRANCH_NAME, 
BRANCH_STREET,
BRANCH_CITY,
BRANCH_ZIP,
BRANCH_PHONE, 
LAST_UPDATED,
BRANCH_STATE

from CDW_SAPP_D_BRANCH_ONE;