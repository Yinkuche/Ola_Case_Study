USE DEFAULT;

DROP TABLE CDW_SAPP_F_CREDIT_CARD_ONE;

CREATE  EXTERNAL TABLE CDW_SAPP_F_CREDIT_CARD_ONE(
CUST_CC_NO string,
TIMEID string,
CUST_SSN string,
BRANCH_CODE string,
TRANSACTION_TYPE string,
TRANSACTION_VALUE string,
LAST_UPDATED timestamp) 
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'
LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_F_CREDIT_CARD";

DROP TABLE CDW_SAPP_F_CREDIT_CARD;

SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;

CREATE  EXTERNAL TABLE CDW_SAPP_F_CREDIT_CARD(
CUST_CC_NO string,
TIMEID string,
CUST_SSN string,
TRANSACTION_TYPE string,
TRANSACTION_VALUE string,
LAST_UPDATED timestamp) 
PARTITIONED BY (BRANCH_CODE string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'

LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_F_CREDIT_CARD10";


SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;
INSERT OVERWRITE TABLE CDW_SAPP_F_CREDIT_CARD
PARTITION (BRANCH_CODE)
SELECT CUST_CC_NO,
TIMEID,
CUST_SSN,
TRANSACTION_TYPE,
TRANSACTION_VALUE,
LAST_UPDATED,
BRANCH_CODE

from CDW_SAPP_F_CREDIT_CARD_ONE;