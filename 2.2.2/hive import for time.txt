USE DEFAULT;

DROP TABLE CDW_SAPP_D_TIME_ONE;

CREATE  EXTERNAL TABLE CDW_SAPP_D_TIME_ONE(
TIMEID int,
DAY string,
MONTH string,
QUARTER string,
YEAR string) 
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'
LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_D_TIME";

DROP TABLE CDW_SAPP_D_TIME;

SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;

CREATE  EXTERNAL TABLE CDW_SAPP_D_TIME(
TIMEID int,
DAY string,
MONTH string,
YEAR string)  
PARTITIONED BY (QUARTER string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' ESCAPED BY '"' LINES TERMINATED BY '\n'

LOCATION "/user/maria_dev/Credit_Card_System/CDW_SAPP_D_TIME10";


SET hive.exec.dynamic.partition=true;
SET hive.exec.dynamic.partition.mode=nonstrict;
INSERT OVERWRITE TABLE CDW_SAPP_D_TIME
PARTITION (QUARTER)
SELECT TIMEID,
DAY,
MONTH,
YEAR,
QUARTER

from CDW_SAPP_D_TIME_ONE;